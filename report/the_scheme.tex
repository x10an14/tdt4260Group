\section{The DCPT And TS Implementation}

For testing the prefetchers using the M5 simulator, we implement three callbacks
provided by the framework.

\begin{enumerate}
	\item \textbf{prefetch\_init}
		This function is called before the first memory access to let the
		prefetchers initialize their data structures.
	\item \textbf{prefetch\_access}
		This function is called whenever the cache is accessed, both for hits
		and for misses.
	\item \textbf{prefetch\_complete}
		This function is called when a prefetch request has been completed.
\end{enumerate}

\subsection{Simulator Setup}

\todo[inline]{Describing the simulator setup and config values. \\
Describe the ``default simulator setup'' better. Explicitly state the conditions
of the default simulator.}

The simulator is configured with a block size of 64 bytes. The largest possible
memory address is $2^{28}-1$, and up to 100 prefetching requests can be pending
at once.

\subsection{TS Implementation}

For the TS implementation, we only implement the
\textbf{prefetch\_access} function. The implementation directly follows the
algorithm.

\todo[inline]{Og implementasjonen av prefetch\_access da??? -C}

\subsection{DCPT Implementation}

\todo[inline]{Describing our DCPT implementation}

The DCPT implementation attempts to follow the pseudocode described in the
original implementation~\cite{dcpt} as closely as possible.

The data structures are allocated statically, so there is nothing to do in
\textbf{prefetch\_init}. The main algorithm is implemented in
\textbf{prefetch\_access}, and in \textbf{prefetch\_complete} we remove blocks
from the \emph{inFlight} set.

\todo[inline]{Du må forklare hva som gjøres inni hver av funksjonene. ikke bare
skrive ``Den var implementert. Den var ikke implementert.'' Han vil vite
\textit{vår implementasjon}, ikke at vi implementerte det... =/}

The prefetcher can be configured by adjusting three parameters; the number of
entries in the table, the number of deltas per entry and the size in bits of
each delta.

\subsection{Overhead}

The TS prefetcher requires one bit per cache block to store the
associated tag. Since each cache block is 64 bytes, this amounts to about 0.2\%
overhead.

The amount of storage used by the DCPT prefetcher, however, can be configured
independently of the cache and memory sizes. The only limitation being that each
entry contains three address fields which must be wide enough to cover the
address space of the system. Apart from that, we can arbitrarily choose the size
and number of deltas, as well as the number of entries in the table.

\todo[inline]{Kanskje legge inn minium plass nødvendig mhp. address space? Eller
bare gi en fin formel med de forskjellige variablene?}

\todo[inline]{Explain your scheme in detail\\
- Trick: Add an informative figure that helps explain
your scheme\\
- If your scheme is complex, an informative example
may be in order\\}
